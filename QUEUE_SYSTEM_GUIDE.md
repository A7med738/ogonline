# ุฏููู ูุธุงู ุทุงุจูุฑ ุงููุฑุถู - ุงุญุฌุฒูู

## ูุธุฑุฉ ุนุงูุฉ
ุชู ุชุทููุฑ ูุธุงู ุทุงุจูุฑ ูุชูุฏู ููู ุฏูุชูุฑ ุนูู ุญุฏุฉุ ุญูุซ ูุญุตู ูู ูุฑูุถ ุนูู ุฑูู ุทุงุจูุฑ ูุฑูุฏ ูููููู ุฑุคูุฉ ููุถุนู ูู ุงูุทุงุจูุฑ ูููุช ุงูุงูุชุธุงุฑ ุงููุชููุน.

## ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ

### ๐ฏ **ูุธุงู ุงูุทุงุจูุฑ ุงูุฐูู**
- **ุฑูู ุทุงุจูุฑ ูุฑูุฏ**: ูู ูุฑูุถ ูุญุตู ุนูู ุฑูู ุทุงุจูุฑ ุชููุงุฆูุงู
- **ููุถุน ูู ุงูุทุงุจูุฑ**: ูุฑู ุงููุฑูุถ ุชุฑุชูุจู ุจูู ุงููุฑุถู ุงูููุชุธุฑูู
- **ููุช ุงูุชุธุงุฑ ูุชููุน**: ุญุณุงุจ ุฏููู ูููุช ุงูุงูุชุธุงุฑ ุจุงูุฏูุงุฆู

### ๐ **ุฅุฏุงุฑุฉ ุงูุทุงุจูุฑ ุงูุชููุงุฆูุฉ**
- **ุญุณุงุจ ุชููุงุฆู**: ูุชู ุญุณุงุจ ุฑูู ุงูุทุงุจูุฑ ูููุถุนู ุชููุงุฆูุงู ุนูุฏ ุงูุญุฌุฒ
- **ุชุญุฏูุซ ููุฑู**: ูุชู ุชุญุฏูุซ ููุงุถุน ุงููุฑุถู ุนูุฏ ุฅูุบุงุก ููุนุฏ
- **ุฅุญุตุงุฆูุงุช ุฏูููุฉ**: ุชุชุจุน ุนุฏุฏ ุงููุฑุถู ูููุช ุงูุงูุชุธุงุฑ ููู ุนูุงุฏุฉ

## ุงูุจููุฉ ุงูุชูููุฉ

### ๐๏ธ **ุงูุฌุฏุงูู ุงูุฌุฏูุฏุฉ**

#### `book_service_clinic_queues`
```sql
- clinic_id: ูุนุฑู ุงูุนูุงุฏุฉ
- current_queue_number: ุฑูู ุงูุทุงุจูุฑ ุงูุญุงูู
- total_patients_today: ุฅุฌูุงูู ุงููุฑุถู ุงูููู
- average_consultation_time: ูุชูุณุท ููุช ุงูุงุณุชุดุงุฑุฉ (ุฏูููุฉ)
```

#### `book_service_queue_status`
```sql
- clinic_id: ูุนุฑู ุงูุนูุงุฏุฉ
- status: ุญุงูุฉ ุงูุทุงุจูุฑ (active, paused, closed)
- current_serving_queue_number: ุฑูู ุงูุทุงุจูุฑ ููุฏ ุงูุฎุฏูุฉ
- next_queue_number: ุฑูู ุงูุทุงุจูุฑ ุงูุชุงูู
- estimated_wait_time: ููุช ุงูุงูุชุธุงุฑ ุงููุชููุน
```

### ๐ง **ุงููุธุงุฆู ุงูุฌุฏูุฏุฉ**

#### `get_next_queue_number(clinic_uuid)`
- ุชุญุณุจ ุฑูู ุงูุทุงุจูุฑ ุงูุชุงูู ููุนูุงุฏุฉ
- ุชุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ ุงูููุงุนูุฏ ุงููุคูุฏุฉ ูุงููุนููุฉ ููุท

#### `calculate_queue_position(clinic_uuid, appointment_uuid)`
- ุชุญุณุจ ููุถุน ุงููุฑูุถ ูู ุงูุทุงุจูุฑ
- ุชุนุฏ ุงููุฑุถู ุงูููุชุธุฑูู ูุจู ูุฐุง ุงููุฑูุถ

#### `calculate_wait_time(clinic_uuid, appointment_uuid)`
- ุชุญุณุจ ููุช ุงูุงูุชุธุงุฑ ุงููุชููุน ุจุงูุฏูุงุฆู
- ุชุนุชูุฏ ุนูู ูุชูุณุท ููุช ุงูุงุณุชุดุงุฑุฉ ูููุถุน ุงููุฑูุถ

### โก **Triggers ุงูุชููุงุฆูุฉ**

#### `trigger_update_clinic_queue`
- ูุชู ุชุดุบููู ุนูุฏ ุฅุถุงูุฉ ููุนุฏ ุฌุฏูุฏ
- ูุญุณุจ ุฑูู ุงูุทุงุจูุฑ ูููุถุนู ูููุช ุงูุงูุชุธุงุฑ ุชููุงุฆูุงู
- ูุญุฏุซ ุฅุญุตุงุฆูุงุช ุงูุทุงุจูุฑ

#### `trigger_update_clinic_queue_cancellation`
- ูุชู ุชุดุบููู ุนูุฏ ุฅูุบุงุก ููุนุฏ
- ูุนูุฏ ุญุณุงุจ ููุงุถุน ุงููุฑุถู ุงููุชุจููู
- ูุญุฏุซ ุฃููุงุช ุงูุงูุชุธุงุฑ

## ุงููุงุฌูุฉ ุงููุญุฏุซุฉ

### ๐ฑ **ุตูุญุฉ ุชุฃููุฏ ุงูููุนุฏ**
- ุนุฑุถ ุฑูู ุงูุทุงุจูุฑ ุจุดูู ุจุงุฑุฒ
- ููุถุน ุงููุฑูุถ ูู ุงูุทุงุจูุฑ
- ููุช ุงูุงูุชุธุงุฑ ุงููุชููุน ุจุงูุฏูุงุฆู
- ูุนูููุงุช ูููุฉ ูููุฑูุถ

### ๐ **ุตูุญุฉ ููุงุนูุฏู**
- ุนุฑุถ ูุนูููุงุช ุงูุทุงุจูุฑ ูู ูู ููุนุฏ
- ุจุทุงูุงุช ููููุฉ ููุนูููุงุช ุงูุทุงุจูุฑ
- ุชุญุฏูุซ ููุฑู ูููุนูููุงุช

## ูุชูุณุทุงุช ุฃููุงุช ุงูุงุณุชุดุงุฑุฉ

| ุงูุชุฎุตุต | ูุชูุณุท ุงูููุช (ุฏูููุฉ) |
|---------|---------------------|
| ุทุจ ุนุงู | 15 |
| ุทุจ ุฃุทูุงู | 20 |
| ูุณุงุก ูุชูููุฏ | 25 |
| ุฃูุฑุงุถ ุงูููุจ | 30 |
| ุฌุฑุงุญุฉ ุงูุนุธุงู | 25 |
| ุฃูุฑุงุถ ุฌูุฏูุฉ | 15 |
| ุฃูู ูุฃุฐู ูุญูุฌุฑุฉ | 20 |
| ุทุจ ุงูุนููู | 20 |
| ุทุจ ุงูุฃุณูุงู | 30 |

## ูุซุงู ุนูู ุงูุนูู

### ุนูุฏ ุญุฌุฒ ููุนุฏ ุฌุฏูุฏ:
1. **ุงููุฑูุถ ูุญุฌุฒ**: ููุนุฏ ูุน ุฏ. ุฃุญูุฏ (ุทุจ ุนุงู)
2. **ุงููุธุงู ูุญุณุจ**: ุฑูู ุงูุทุงุจูุฑ = 5ุ ููุถุน = 3ุ ุงูุชุธุงุฑ = 30 ุฏูููุฉ
3. **ุงููุฑูุถ ูุฑู**: "ุฑูู ุทุงุจูุฑู #5ุ ููุถุนู ุงูุซุงูุซุ ุงูุชุธุงุฑ ูุชููุน 30 ุฏูููุฉ"

### ุนูุฏ ุฅูุบุงุก ููุนุฏ:
1. **ูุฑูุถ ููุบู**: ููุนุฏ ุฑูู 3
2. **ุงููุธุงู ูุนูุฏ ุญุณุงุจ**: ููุงุถุน ุงููุฑุถู ุงููุชุจููู
3. **ุงููุฑุถู ูุฑู**: ููุงุถุน ูุญุฏุซุฉ ูุฃููุงุช ุงูุชุธุงุฑ ุฌุฏูุฏุฉ

## ุงูุฃูุงู ูุงูุฃุฏุงุก

### ๐ **ุณูุงุณุงุช ุงูุฃูุงู**
- ุฌููุน ุงูุฌุฏุงูู ูุญููุฉ ุจู RLS
- ุงููุฑุถู ูุฑูู ููุงุนูุฏูู ููุท
- ูุนูููุงุช ุงูุทุงุจูุฑ ูุฑุฆูุฉ ููุฌููุน (ููุงุณุชุนูุงู)

### โก **ุงูุฃุฏุงุก**
- ููุงุฑุณ ูุญุณูุฉ ููุงุณุชุนูุงูุงุช ุงูุณุฑูุนุฉ
- Realtime ููุชุญุฏูุซุงุช ุงูููุฑูุฉ
- ุญุณุงุจ ุฐูู ูุชูููู ุงูุญูู ุนูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

## ุงูุชุทุจูู

### 1. ุชุดุบูู ููู SQL
```bash
# ุชุดุบูู ุงูููู ุงูุฑุฆูุณู
supabase/migrations/20250125000000_create_book_service_health_system.sql

# ุชุดุบูู ูุธุงู ุงูุทุงุจูุฑ
supabase/migrations/20250125000001_add_queue_system.sql
```

### 2. ุงุฎุชุจุงุฑ ุงููุธุงู
1. ุงุญุฌุฒ ููุนุฏ ุฌุฏูุฏ
2. ุชุญูู ูู ุฑูู ุงูุทุงุจูุฑ ูู ุตูุญุฉ ุงูุชุฃููุฏ
3. ุชุญูู ูู ูุนูููุงุช ุงูุทุงุจูุฑ ูู ุตูุญุฉ ููุงุนูุฏู
4. ุฌุฑุจ ุฅูุบุงุก ููุนุฏ ูุฑุงูุจ ุงูุชุญุฏูุซุงุช

## ุงููุฒุงูุง

### ูููุฑุถู:
- โ ุดูุงููุฉ ูุงููุฉ ูู ุงูุทุงุจูุฑ
- โ ูุนุฑูุฉ ุฏูููุฉ ูููุช ุงูุงูุชุธุงุฑ
- โ ุชุฌุฑุจุฉ ุญุฌุฒ ูุญุณูุฉ

### ููุฃุทุจุงุก:
- โ ุฅุฏุงุฑุฉ ุฃูุถู ููุทุงุจูุฑ
- โ ุฅุญุตุงุฆูุงุช ุฏูููุฉ
- โ ุชูููู ุงูุงุฒุฏุญุงู

### ููุฅุฏุงุฑุฉ:
- โ ุชุชุจุน ุฃุฏุงุก ุงูุนูุงุฏุงุช
- โ ุชุญุณูู ุชูุฒูุน ุงููุฑุถู
- โ ุชูุงุฑูุฑ ููุตูุฉ

---
**ุชุงุฑูุฎ ุงูุชุทููุฑ**: 2025-01-25  
**ุงูุฅุตุฏุงุฑ**: 2.0  
**ุงูุญุงูุฉ**: ุฌุงูุฒ ููุฅูุชุงุฌ โ
